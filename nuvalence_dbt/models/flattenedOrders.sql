SELECT id,
  JSON_EXTRACT_SCALAR(entity_json, '$.ponumber') AS ponumber,
  JSON_EXTRACT_SCALAR(entity_json, '$.orderDate') AS order_date,
  JSON_EXTRACT_SCALAR(entity_json, '$.shipDate') AS ship_date,
  JSON_EXTRACT_SCALAR(entity_json, '$.customer.firstName') AS customer_first_name,
  JSON_EXTRACT_SCALAR(entity_json, '$.customer.lastName') AS customer_last_name,
  JSON_EXTRACT_SCALAR(entity_json, '$.customer.email') AS customer_email,
  JSON_EXTRACT_SCALAR(entity_json, '$.customer.phone') AS customer_phone,
  JSON_EXTRACT_SCALAR(entity_json, '$.customer.paymentMethod') AS payment_method,
  JSON_EXTRACT_SCALAR(entity_json, '$.shipTo.address1') AS shipto_address1,
  JSON_EXTRACT_SCALAR(entity_json, '$.shipTo.address2') AS shipto_address2,
  JSON_EXTRACT_SCALAR(entity_json, '$.shipTo.city') AS shipto_city,
  JSON_EXTRACT_SCALAR(entity_json, '$.shipTo.state') AS shipto_status,
  JSON_EXTRACT_SCALAR(entity_json, '$.shipTo.postalCode') AS shipto_postal_code,
  JSON_EXTRACT_SCALAR(entity_json, '$.shipTo.country') AS shipto_country,
  JSON_EXTRACT_SCALAR(entity_json, '$.customer.billingAddress.address1') AS billto_address1,
  JSON_EXTRACT_SCALAR(entity_json, '$.customer.billingAddress.address2') AS billto_address2,
  JSON_EXTRACT_SCALAR(entity_json, '$.customer.billingAddress.city') AS billto_city,
  JSON_EXTRACT_SCALAR(entity_json, '$.customer.billingAddress.state') AS billto_status,
  JSON_EXTRACT_SCALAR(entity_json, '$.customer.billingAddress.postalCode') AS billto_postal_code,
  JSON_EXTRACT_SCALAR(entity_json, '$.customer.billingAddress.country') AS billto_country
FROM {{ ref('orders') }}